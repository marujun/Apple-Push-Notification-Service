/**
 * Created with JetBrains WebStorm.
 * Date: 05/07/12
 * Time: 09:23
 * To change this template use File | Settings | File Templates.
 */

var apns = require('./index');

var options = {
    cert: '/Users/mrj/WebStormProject/demo/pushApple/routes/../public/secret/PushChatCert.pem',
    key:  '/Users/mrj/WebStormProject/demo/pushApple/routes/../public/secret/PushChatKey.pem',
    passphrase: 'testpush',                 /* A passphrase for the Key file */
    gateway: 'gateway.sandbox.push.apple.com',
    port: 2195,
    enhanced: true,
    errorCallback: false,
    cacheLength: 100
};

var apnsConnection = new apns.Connection(options);

var token = '47f7517708a26e47a3974f1bbd36621e61ae997983bbc795cb8cc1571fa7302e';

var myDevice = new apns.Device(token);

var note = new apns.Notification();

note.expiry = Math.floor(Date.now() / 1000) + 3600; // Expires 1 hour from now.
note.badge = 3;
note.sound = "ping.aiff";
note.alert = "You have a new message";
note.payload = {'messageFrom': 'Caroline'};
note.device = myDevice;

apnsConnection.sendNotification(note);